//comboMenu
$(function() {
    	var categories = [ {
			"value" : 1,
			"text" : "My Documents",
			"children" : [ {
				"value" : 11,
				"text" : "Photos",
				"children" : [ {
					"value" : 111,
					"text" : "Friend",
					"children" : [ {
						"value" : 1111,
						"text" : "yjb",
						"children" : [ {
							"value" : 11111,
							"text" : "小布丁"
						} ]
					}, {
						"value" : 1112,
						"text" : "zn"
					} ]
				}, {
					"value" : 112,
					"text" : "Wife"
				}, {
					"value" : 113,
					"text" : "Company"
				} ]
			}, {
				"value" : 12,
				"text" : "Program Files",
				"children" : [ {
					"value" : 121,
					"text" : "Intel"
				}, {
					"value" : 122,
					"text" : "Java"
				}, {
					"value" : 123,
					"text" : "Microsoft Office"
				}, {
					"value" : 124,
					"text" : "Games"
				} ]
			}, {
				"value" : 13,
				"text" : "index.html"
			}, {
				"value" : 14,
				"text" : "about.html"
			}, {
				"value" : 15,
				"text" : "welcome.html"
			} ]
		}, {
			"value" : 2,
			"text" : "Your Documents"
		} ];

		$("#cmbDiv").comboMenu({
			height : 32,
			width : 180,
			popWidth : 120,
			useSearch : true,
			title : "品类",
			data : categories,
			onShow : function() {
				// alert("onShow");
			},
			onHide : function() {
				// alert("onHide");
			},
			onClick : function() {
				// alert("onClick");
			},
			onChanged : function(oldValue, newValue) {
				// alert("onChanged：old=" + (!oldValue ? "" : oldValue.value) + "new=" + (!newValue ? "" : newValue.value));
			}
		});
		/*$("#cmbDiv2").comboMenu({
			height : 35,
			width : 180,
			popWidth : 120,
			useSearch : true,
			title : "品类",
			data : categories,
			onShow : function() {
				// alert("onShow");
			},
			onHide : function() {
				// alert("onHide");
			},
			onClick : function() {
				// alert("onClick");
			},
			onChanged : function(oldValue, newValue) {
				// alert("onChanged：old=" + (!oldValue ? "" : oldValue.value) + "new=" + (!newValue ? "" : newValue.value));
			}
		});
		$("#cmbDiv3").comboMenu({
			height : 35,
			width : 180,
			popWidth : 120,
			useSearch : true,
			title : "品类",
			data : categories,
			onShow : function() {
				// alert("onShow");
			},
			onHide : function() {
				// alert("onHide");
			},
			onClick : function() {
				// alert("onClick");
			},
			onChanged : function(oldValue, newValue) {
				// alert("onChanged：old=" + (!oldValue ? "" : oldValue.value) + "new=" + (!newValue ? "" : newValue.value));
			}
		});*/

		$("#cmbDiv").comboMenu("setValue", "113");
		/*$("#cmbDiv2").comboMenu("setValue", "112");
		$("#cmbDiv3").comboMenu("setValue", "111");*/
		
		
    
});
/**
 * comboMenu控件
 * 
 * @author yinjiabin
 */
(function($) {

	function init($target) {

		var options = $target.data('comboMenu').options;
		var data = processData(options.data, options.hasAllData);
		var $popArr = new Array();

		createCombo();
		createPop0();
		createOtherPops();
		if (options.addParentAndLevel) {
			addParentAndLevel(data, null, 0);
		}
		$target.data("comboMenuData", data);
		$target.data("popArr", $popArr);
		changeValue($target, findSelectedValue(data, ""));

		/**
		 * 创建combo
		 */
		function createCombo() {

			$target.addClass("comboMenu in");

			var $prefix = $('<span class="prefix"></span>');
			var $cmbTxt = $('<a href="javascript:void(0);" class="comboMenu_text"></a>');
			var $arrowIn = $('<span class="arrow in" style=""></span>');

			$target.append($prefix).append($cmbTxt).append($arrowIn);

			$target.height(options.height);
			$target.width(options.width);

			$prefix.css("padding-top", (options.height - 21) / 2);
			$cmbTxt.css("padding-top", (options.height - 21) / 2);

			if (options.title && options.title.length > 0) {
				$prefix.append(options.title + ": ");
			}

			$cmbTxt.width($target.width() - $prefix.width() - 30);
			// 因为$cmbTxt的padding-top 和 padding-left的和为6
			$cmbTxt.height(options.height - 6);

			$arrowIn.css("margin-top", (options.height - 25) / 2);

			$cmbTxt.bind("click", function() {
				comboClick($target);
			});
			$arrowIn.bind("click", function() {
				comboClick($target);
			});
		}

		/**
		 * 创建pop0
		 */
		function createPop0() {

			var $pop0 = $('<div class="popup popup_0" index="0" style="display: none;"></div></div>');

			$popArr.push($pop0);

			$pop0.width(options.width + 2);
			$pop0.css("top", options.height);

			$target.append($pop0);

			var $searchDiv = $('<div class="comboMenu_search"><span class="prefix">搜索:</span><input type="text" log="search_cate"><span class="cf"></span></div><div class="search-bottom"></div><div class="popup_wrap"></div>');
			$pop0.append($searchDiv);

			var $search = $pop0.find("[log=search_cate]");
			$search.bind("input protertychange", function(e) {
				searchChanged(e, $target);
			});
			$search.width(options.width - 68);

			if (options.useSearch == false) {
				$searchDiv.each(function() {
					$(this).hide();
				});
			}

			$pop0.append('<div class="popuplist"></div>');
		}

		/**
		 * 创建pop1-pop4
		 */
		function createOtherPops() {

			if (!options.popWidth) {
				options.popWidth = options.width;
			}
			var showTop = options.height;

			if (options.useSearch) {
				showTop = showTop + 34;
			}

			var $pop1 = $('<div class="popup popup_1" index="1" style="display: none;"><div class="popuplist" style="height: auto;"></div></div>');
			var $pop2 = $('<div class="popup popup_2" index="2" style="display: none;"><div class="popuplist" style="height: auto;"></div></div>');
			var $pop3 = $('<div class="popup popup_3" index="3" style="display: none;"><div class="popuplist" style="height: auto;"></div></div>');
			var $pop4 = $('<div class="popup popup_4" index="4" style="display: none;"><div class="popuplist" style="height: auto;"></div></div>');

			$popArr.push($pop1);
			$popArr.push($pop2);
			$popArr.push($pop3);
			$popArr.push($pop4);

			$target.append($pop1);
			$target.append($pop2);
			$target.append($pop3);
			$target.append($pop4);

			$pop1.css("left", options.width);
			$pop1.css("_margin-left", options.width); // 兼容IE6
			$pop1.css("width", options.popWidth);
			$pop1.css("top", showTop);

			$pop2.css("left", options.width + options.popWidth - 1);
			$pop2.css("_margin-left", options.width + options.popWidth - 1); // 兼容IE6
			$pop2.css("width", options.popWidth);
			$pop2.css("top", showTop);

			$pop3.css("left", options.width + options.popWidth + options.popWidth - 2);
			$pop3.css("_margin-left", options.width + options.popWidth + options.popWidth - 2); // 兼容IE6
			$pop3.css("width", options.popWidth);
			$pop3.css("top", showTop);

			$pop4.css("left", options.width + options.popWidth + options.popWidth + options.popWidth - 3);
			$pop4.css("_margin-left", options.width + options.popWidth + options.popWidth + options.popWidth - 3); // 兼容IE6
			$pop4.css("width", options.popWidth);
			$pop4.css("top", showTop);
		}
	}

	/**
	 * 点击combo的事件，需要弹出pop0
	 */
	function comboClick($target) {

		var options = $target.data('comboMenu').options;
		var $popArr = $target.data("popArr");

		if ($popArr[0].css("display") == "none") {
			$popArr[0].find("[log=search_cate]").val("");
			if (options.onShow) {
				var result = options.onShow();
				if (result == false) {
					return;
				}
			}

			var data = $target.data("comboMenuData");

			addMenuItem($target, $popArr[0].find(".popuplist"), data);
			selectValueByLevel($target, 0);
			$popArr[0].show();
		} else {
			$popArr[0].find("[log=search_cate]").val("");
			hideSubPopFrom($target, 0);
		}
		if (options.onClick) {
			options.onClick();
		}
	}

	/**
	 * 检索事件
	 */
	function searchChanged(e, $target) {

		var data = $target.data("comboMenuData");

		if (!data) {
			return;
		}
		var newValue = e.target.value;
		var $popArr = $target.data("popArr");
		var $popuplist = $popArr[0].find(".popuplist");
		if (newValue && newValue != "") {
			var findList = new Array();
			hideSubPopFrom($target, 1);
			findSearchList(e.target.value, data, findList);
			$popuplist.empty();
			addMenuItem($target, $popuplist, findList, true);
		} else {
			$popuplist.empty();
			addMenuItem($target, $popuplist, data);
		}
		selectValueByLevel($target, 0);
	}

	/**
	 * 查找符合条件的数据
	 */
	function findSearchList(val, levData, findList) {

		for (var i = 0; i < levData.length; i++) {

			var tmpData = levData[i];
			if (tmpData.text && tmpData.text.replace(/ /g, "").toLowerCase().indexOf(val.replace(/ /g, "").toLowerCase()) >= 0) {
				findList.push(tmpData);
			}

			if (tmpData.children && tmpData.children.length > 0) {
				findSearchList(val, tmpData.children, findList);
			}
		}
	}

	/**
	 * 给popuplist添加数据。
	 */
	function addMenuItem($target, $popuplist, dataList, isUserParent) {

		var options = $target.data('comboMenu').options;
		var $popArr = $target.data("popArr");

		if (!dataList) {
			return;
		}

		for (var i = 0; i < dataList.length; i++) {
			var $menuItem = $('<a href="javascript:void(0);" class="comboItem"></a>');
			var itemData = dataList[i];
			if (itemData.children && itemData.children.length > 0) {
				$menuItem.addClass("hasLeaf");
			}
			if (isUserParent) {
				$menuItem.append(getDataString(itemData, options.joinStr));
			} else {
				$menuItem.append(itemData.text);
			}
			$menuItem.data("itemData", itemData);
			$menuItem.attr("keyValue", itemData.value);

			// 绑定click事件
			$menuItem.bind('click', function() {
				var $item = $(this);
				var itemData = $item.data("itemData");

				if (!options.allLeafCanSelect && itemData.children && itemData.children.length > 0) {
					return;
				}
				changeValue($target, itemData);
				hideSubPopFrom($target, 0);
			});

			// 绑定mouseover事件
			$menuItem.bind('mouseover', function() {
				var $item = $(this);
				var itemData = $item.data("itemData");

				var level = parseInt($item.parents(".popup").attr("index")) + 1;

				hideSubPopFrom($target, level);

				if (itemData.children && itemData.children.length > 0) {
					addMenuItem($target, $popArr[level].find(".popuplist"), itemData.children);
					selectValueByLevel($target, level);
					$popArr[level].show();
				}
			});

			$popuplist.append($menuItem);
		}
	}

	/**
	 * 给参数data加上parent，以便于在查找的时候，能够找到parent，以显示出text的路径。
	 * 给参数data加上level，以便在处理的时候知道先把的条目的级别。
	 * 
	 * @author yinjiabin
	 */
	function addParentAndLevel(curDataArr, parent, level) {

		if (!curDataArr) {
			return;
		}

		for (var i = 0; i < curDataArr.length; i++) {
			var tmpData = curDataArr[i];
			tmpData.parent = parent;
			tmpData.level = level;
			if (tmpData.children && tmpData.children.length > 0) {
				addParentAndLevel(tmpData.children, tmpData, level + 1);
			}
		}
	}

	/**
	 * 从level级开始隐藏pop。level后的pop都会被隐藏
	 */
	function hideSubPopFrom($target, level) {

		var options = $target.data('comboMenu').options;
		var $popArr = $target.data("popArr");

		if (level == 0 && options.onHide) {
			options.onHide();
		}

		for (var i = level; i < $popArr.length; i++) {
			hideSubPop($popArr[i]);
		}
	}

	/**
	 * 隐藏pop
	 */
	function hideSubPop($pop) {
		var $list = $pop.find(".popuplist");
		$pop.hide();
		$list.empty();
	}

	/**
	 * 根据当前的选择值，选中级别为level的pop中的item条目，以加上class
	 */
	function selectValueByLevel($target, level) {

		var $popArr = $target.data("popArr");

		$popArr[level].find(".current").removeClass("current");

		var curValue = $target.data("selectedValue");

		if (!curValue) {
			return;
		}
		var resultVal = findValueByLevel(curValue, level);

		if (resultVal) {

			$popArr[level].find("[keyValue='" + resultVal.value + "']").addClass("current");
		}
	}

	/**
	 * 根据级别，找到包括一个json对象的父对象的值。在下拉点开时，以找到当前选择值的父节点值时使用。
	 */
	function findValueByLevel(curValue, level) {

		var resultVal = null;

		if (!curValue) {
			return null;
		}
		if (curValue.level > level) {
			resultVal = findValueByLevel(curValue.parent, level);
			if (resultVal) {
				return resultVal;
			}
		} else if (curValue.level == level) {
			return curValue;
		} else {
			return null;
		}
	}

	/**
	 * 在json数组中找到当前值的json对象
	 */
	function findSelectedValue(dataArr, value) {

		if (!dataArr) {
			return null;
		}

		for (var i = 0; i < dataArr.length; i++) {
			if (dataArr[i].value == value) {
				return dataArr[i];
			} else {
				var val = findSelectedValue(dataArr[i].children, value);
				if (val) {
					return val;
				}
			}
		}

		return null;
	}

	/**
	 * 把当前的json值转为字符串
	 */
	function getDataString(tmpData, joinStr) {

		if (!tmpData) {
			return "";
		}
		var txtArr = new Array();
		txtArr.push(tmpData.text);
		var parent = tmpData.parent;
		while (parent) {
			txtArr.push(parent.text);
			parent = parent.parent;
		}
		return txtArr.reverse().join(joinStr);
	}

	/**
	 * 改变值时的处理。如果设置了监听，会触发onChanged事件。如果onChanged返回false,可以让事件的处理取消，值不改变。
	 */
	function changeValue($target, newValue) {

		var oldValue = $target.data("selectedValue");
		var options = $target.data('comboMenu').options;

		if (options.onChanged && oldValue != newValue) {
			var result = options.onChanged(oldValue, newValue);
			if (result == false) {
				return;
			}
		}

		if (options.showSingleLevel == false) {
			$target.find(".comboMenu_text").html(getDataString(newValue, options.joinStr));
		} else {
			$target.find(".comboMenu_text").html(!newValue ? "" : newValue.text);
		}
		$target.data("selectedValue", newValue);
	}

	/**
	 * 把传过来的data处理一下，在拷贝之前，加上全部数据
	 */
	function processData(data, addAllData) {
		var processData = new Array();
		if (addAllData) {
			processData.push({
				value : "",
				text : "全部数据"
			});
		}
		return processData.concat(copyJsonArray(data));
	}

	/**
	 * 拷贝json的数组
	 */
	function copyJsonArray(objArr) {
		var copyArr = new Array();
		if (!objArr) {
			return copyArr;
		}
		for (var i = 0; i < objArr.length; i++) {
			copyArr.push($.extend(true, {}, objArr[i]));
		}
		return copyArr;
	}

	$.fn.comboMenu = function(options, param) {

		var $target = $(this);

		if (typeof options == 'string') {
			return $.fn.comboMenu.methods[options]($target, param);
		}

		options = options || {};

		var state = $target.data('comboMenu');
		if (state) {
			$.extend(state.options, options);
		} else {
			state = $target.data('comboMenu', {
				options : $.extend({}, $.fn.comboMenu.defaults, options)
			});
			init($target);
		}
	};

	/**
	 * 定义的comboMenu的方法
	 */
	$.fn.comboMenu.methods = {
		getValue : function($target) {
			return $target.data("selectedValue");
		},
		setValue : function($target, value) {
			var selectedValue = findSelectedValue($target.data("comboMenuData"), value);
			changeValue($target, selectedValue);
		},
		setData : function($target, data) {
			var options = $target.data('comboMenu').options;
			options.data = data;
			var data = processData(options.data, options.hasAllData);
			if (options.addParentAndLevel) {
				addParentAndLevel(data, null, 0);
			}
			$target.data("comboMenuData", data);
		},
		getOptions : function($target) {
			return $target.data('comboMenu').options;
		},
		hideCombo : function($target) {

			var $popArr = $target.data("popArr");

			if ($popArr[0].css("display") != "none") {
				$popArr[0].find("[log=search_cate]").val("");
				hideSubPopFrom($target, 0);
			}
		}
	};

	/**
	 * comboMenu的默认设置
	 */
	$.fn.comboMenu.defaults = {
		height : 30,
		width : 190,
		popWidth : null, // 除了第一级的下拉菜单，其它下拉菜单的宽。如果不设，会默认与width值相等
		showSingleLevel : true, // 是否只显示选择值的单级值。如果是false,则显示其祖先到本级的值
		allLeafCanSelect : false, // 所有的节点都可以选。默认为false，也就是只有最末级的节点可以选
		hasAllData : false, // 是否添加所有数据可以选择的条目，如果设置为true，在下拉里的第一级的第一行会有一个“全部数据”的选项
		joinStr : " > ", // 搜索功能后，父子级之间的连接字符
		title : "",
		useSearch : true, // 是否用搜索功能
		multiple : false, // 是否可以多选。（目前还不可以，留做扩展用）
		addParentAndLevel : true, // 是否需要控件来添加parent和level属性。默认为true。如果数据已经有parent和level属性了，可设置为fale。
		onShow : null,
		onHide : null,
		onClick : null,
		onChanged : null
	};
})(jQuery);
//daterangepicker
$(function() {
	var cb = function(start, end, label) {
					$('#dateRangePicker span').html(
							start.format('YYYY-MM-D') + ' - '
									+ end.format('YYYY-MM-D'));
				};

	var optionSet1 = {
		startDate : moment().subtract(29, 'days'),
		endDate : moment(),
		minDate : '01/01/2000',
		maxDate : '12/31/2020',
		//dateLimit: { days: 60 },
		showDropdowns : true,
		showWeekNumbers : true,
		timePicker : true,
		timePickerIncrement : 1,
		timePicker12Hour : true,
		ranges : {
			'今天' : [ moment(), moment() ],
			'昨天' : [ moment().subtract(1, 'days'),
					moment().subtract(1, 'days') ],
			'最近 7 天' : [ moment().subtract(6, 'days'),
					moment() ],
			'最近 30 天' : [ moment().subtract(29, 'days'),
					moment() ],
			'本月' : [ moment().startOf('month'),
					moment().endOf('month') ],
			'上月' : [
					moment().subtract(1, 'month').startOf(
							'month'),
					moment().subtract(1, 'month').endOf(
							'month') ]
		},
		opens : 'right',
		buttonClasses : [ 'btn btn-default' ],
		applyClass : 'btn-small btn-primary',
		cancelClass : 'btn-small',
		format : 'MM/DD/YYYY',
		separator : ' to ',
		locale : {
			applyLabel : '确定',
			cancelLabel : '取消',
			fromLabel : '从',
			toLabel : '到',
			customRangeLabel : '自定义',
			customs:[{label:'按月',type:'monthcalendar'},{label:'按周',type:'weekcalendar'},{label:'按天',type:'singlecalendar'}],
			customRangeLabelWeek : "按周",
			daysOfWeek : [ '周日', '周一', '周二', '周三', '周四',
					'周五', '周六' ],
			monthNames : [ '一月', '二月', '三月', '四月', '五月',
					'六月', '七月', '八月', '九月', '十月', '十一月',
					'十二月' ],
			firstDay : 1
		}
	};

	$('#dateRangePicker span').html(
			moment().subtract(29, 'days').format(
					'YYYY-MM-D')
					+ ' - ' + moment().format('YYYY-MM-D'));

	$('#dateRangePicker').daterangepicker(optionSet1, cb);
		
		
    
});
//echarts
$(function() {
       //--- 地图 ---
	var myChart = echarts.init(document.getElementById('echartsmap'));
	var option = {
		title : {
			text: 'iphone销量',
			subtext: '纯属虚构',
			x:'center'
		},
		tooltip : {
			trigger: 'item'
		},
		legend: {
			orient: 'vertical',
			x:'left',
			data:['iphone3','iphone4','iphone5']
		},
		dataRange: {
			min: 0,
			max: 2500,
			x: 'left',
			y: 'bottom',
			text:['高','低'],           // 文本，默认为数值文本
			calculable : true
		},
		toolbox: {
			show: true,
			orient : 'vertical',
			x: 'right',
			y: 'center',
			feature : {
				mark : {show: true},
				dataView : {show: true, readOnly: false},
				restore : {show: true},
				saveAsImage : {show: true}
			}
		},
		roamController: {
			show: true,
			x: 'right',
			mapTypeControl: {
				'china': true
			}
		},
		series : [
			{
				name: 'iphone3',
				type: 'map',
				mapType: 'china',
				roam: false,
				itemStyle:{
					normal:{label:{show:true}},
					emphasis:{label:{show:true}}
				},
				data:[
					{name: '北京',value: Math.round(Math.random()*1000)},
					{name: '天津',value: Math.round(Math.random()*1000)},
					{name: '上海',value: Math.round(Math.random()*1000)},
					{name: '重庆',value: Math.round(Math.random()*1000)},
					{name: '河北',value: Math.round(Math.random()*1000)},
					{name: '河南',value: Math.round(Math.random()*1000)},
					{name: '云南',value: Math.round(Math.random()*1000)},
					{name: '辽宁',value: Math.round(Math.random()*1000)},
					{name: '黑龙江',value: Math.round(Math.random()*1000)},
					{name: '湖南',value: Math.round(Math.random()*1000)},
					{name: '安徽',value: Math.round(Math.random()*1000)},
					{name: '山东',value: Math.round(Math.random()*1000)},
					{name: '新疆',value: Math.round(Math.random()*1000)},
					{name: '江苏',value: Math.round(Math.random()*1000)},
					{name: '浙江',value: Math.round(Math.random()*1000)},
					{name: '江西',value: Math.round(Math.random()*1000)},
					{name: '湖北',value: Math.round(Math.random()*1000)},
					{name: '广西',value: Math.round(Math.random()*1000)},
					{name: '甘肃',value: Math.round(Math.random()*1000)},
					{name: '山西',value: Math.round(Math.random()*1000)},
					{name: '内蒙古',value: Math.round(Math.random()*1000)},
					{name: '陕西',value: Math.round(Math.random()*1000)},
					{name: '吉林',value: Math.round(Math.random()*1000)},
					{name: '福建',value: Math.round(Math.random()*1000)},
					{name: '贵州',value: Math.round(Math.random()*1000)},
					{name: '广东',value: Math.round(Math.random()*1000)},
					{name: '青海',value: Math.round(Math.random()*1000)},
					{name: '西藏',value: Math.round(Math.random()*1000)},
					{name: '四川',value: Math.round(Math.random()*1000)},
					{name: '宁夏',value: Math.round(Math.random()*1000)},
					{name: '海南',value: Math.round(Math.random()*1000)},
					{name: '台湾',value: Math.round(Math.random()*1000)},
					{name: '香港',value: Math.round(Math.random()*1000)},
					{name: '澳门',value: Math.round(Math.random()*1000)}
				]
			},
			{
				name: 'iphone4',
				type: 'map',
				mapType: 'china',
				itemStyle:{
					normal:{label:{show:true}},
					emphasis:{label:{show:true}}
				},
				data:[
					{name: '北京',value: Math.round(Math.random()*1000)},
					{name: '天津',value: Math.round(Math.random()*1000)},
					{name: '上海',value: Math.round(Math.random()*1000)},
					{name: '重庆',value: Math.round(Math.random()*1000)},
					{name: '河北',value: Math.round(Math.random()*1000)},
					{name: '安徽',value: Math.round(Math.random()*1000)},
					{name: '新疆',value: Math.round(Math.random()*1000)},
					{name: '浙江',value: Math.round(Math.random()*1000)},
					{name: '江西',value: Math.round(Math.random()*1000)},
					{name: '山西',value: Math.round(Math.random()*1000)},
					{name: '内蒙古',value: Math.round(Math.random()*1000)},
					{name: '吉林',value: Math.round(Math.random()*1000)},
					{name: '福建',value: Math.round(Math.random()*1000)},
					{name: '广东',value: Math.round(Math.random()*1000)},
					{name: '西藏',value: Math.round(Math.random()*1000)},
					{name: '四川',value: Math.round(Math.random()*1000)},
					{name: '宁夏',value: Math.round(Math.random()*1000)},
					{name: '香港',value: Math.round(Math.random()*1000)},
					{name: '澳门',value: Math.round(Math.random()*1000)}
				]
			},
			{
				name: 'iphone5',
				type: 'map',
				mapType: 'china',
				itemStyle:{
					normal:{label:{show:true}},
					emphasis:{label:{show:true}}
				},
				data:[
					{name: '北京',value: Math.round(Math.random()*1000)},
					{name: '天津',value: Math.round(Math.random()*1000)},
					{name: '上海',value: Math.round(Math.random()*1000)},
					{name: '广东',value: Math.round(Math.random()*1000)},
					{name: '台湾',value: Math.round(Math.random()*1000)},
					{name: '香港',value: Math.round(Math.random()*1000)},
					{name: '澳门',value: Math.round(Math.random()*1000)}
				]
			}
		]
	};
  
	myChart.setOption(option);
});
//highcharts
$(function() {
   var chart = new Highcharts.Chart({
        chart: {
            renderTo: 'highcharts3dcolumn',
            type: 'column',
            margin: 75,
            options3d: {
                enabled: true,
                alpha: 15,
                beta: 15,
                depth: 50,
                viewDistance: 25
            }
        },
        title: {
            text: 'Chart rotation demo'
        },
        subtitle: {
            text: 'Test options by dragging the sliders below'
        },
        plotOptions: {
            column: {
                depth: 25
            }
        },
        series: [{
            data: [29.9, 71.5, 106.4, 129.2, 144.0, 176.0, 135.6, 148.5, 216.4, 194.1, 95.6, 54.4]
        }]
    });
    

    // Activate the sliders
    $('#R0').on('change', function(){
        chart.options.chart.options3d.alpha = this.value;
        showValues();
        chart.redraw(false);
    });
    $('#R1').on('change', function(){
        chart.options.chart.options3d.beta = this.value;
        showValues();
        chart.redraw(false);
    });

    function showValues() {
        $('#R0-value').html(chart.options.chart.options3d.alpha);
        $('#R1-value').html(chart.options.chart.options3d.beta);
    }
    showValues();
});
$.widget("ui.soneLeftMenu", {
    options: {
        value: 0
    },

    _create: function() {
        this.element.addClass("wrap");
        var scope = this;

        $.ajax({
            url: "/left.menu.json",
            type: "GET",
            success: function(mydata) {
                try{
                    mydata = $.parseJSON(mydata);
                }catch(e){
                }
                var tpl = ' <div class="sone-left-menu">';
                $.each(mydata, function(n, item){
                    tpl += '<div id="market" class="item item-1">'+
                        '<div class="itm-lv1">'+
                        '<div class="tit">'+
                        '<span class="'+item.iconClass+'"></span>'+
                        '<span>'+item.name+'</span>'+
                        '<s>3</s>'+
                        '</div>'+
                        '<div class="con">'+
                        '<div class="info">';
                    $.each(item.info, function (n,i) {
                        tpl +='<span><b>'+i.value+'</b>'+i.lable+'</span>';
                    });
                    tpl +='</div>'+
                        '<div class="price">'+
                        '<strong>'+item.price.value+'</strong>'+item.price.lable+
                        '</div>'+
                        '</div>'+
                        '</div>'+
                        '<div class="itm-lv2">'+
                        '<ul>';
                    $.each(item.children, function (n, ch) {
                        tpl += '<li><a href="'+ch.url+'">'+ch.name+'</a></li>';
                    });
                    tpl +='</ul>'+
                        '</div>'+
                        '</div>'; });

                tpl += '<div class="resizer"><b></b></div>'+
                    '</div>';

                scope.element.html(tpl);

                scope._update(mydata);
            }});
    },

    _setOption: function(key, value) {
        this.options[key] = value;

    },

    _update: function(data) {
        
        this._initEvents();
    },

    _initEvents: function(element) {
        var _ele = element || this.element;

        $(".resizer", _ele).click(function(){
            $(".wrap").toggleClass("narrow-wrap");
            $("#page-wrapper").toggleClass("narrow-content");
            $(".item", _ele).find(".itm-lv2").removeAttr("style");
        });

        $(".item .itm-lv1", _ele).click(function(){
            if(!$(".wrap", _ele).hasClass("narrow-wrap")){
                if($(this).parent().hasClass("item-open")) {
                    $(this).parent().removeClass("item-open");
                }
                else{
                    $(this).parents(".sone-left-menu", _ele).find(".item-open").removeClass("item-open");
                    $(this).parent().addClass("item-open");
                }
            }
        });

        $(".sone-left-menu .item", _ele).hover(function(){
            if($(".wrap").hasClass("narrow-wrap")){
                if($(this).hasClass("item-open")){
                    isOpen=true;
                }
                else{
                    isOpen=false;
                }
                $(this).addClass("item-open").find(".itm-lv2").show();
            }
        },function(){
            if($(".wrap").hasClass("narrow-wrap")){
                if(!isOpen){
                    $(this).removeClass("item-open");
                }
                $(this).find(".itm-lv2").hide();
            }
        });
        $(".itm-lv2 a", _ele).click(function(){
            $(this).parent().siblings("li").find("a").removeClass("curr");
            $(this).addClass("curr");
        });

    },

    _destroy:function(){
        this.element
            .removeClass('wrap')
            .text("");
        $.Widget.prototype.destroy.call(this);

    }
});

/**
 * 需求度图谱jquery插件
 * @author songquanwang
 */
 ;var mockData = {
	key : "血糖仪",
	period : "2014-10-14 - 2014-10-14",
	features : [{
				"ratio" : 140,
				"value_r" : 830,
				"value" : 110,
				"feature" : "血糖仪",
				"attrValues" : [],
				"attrName" : "类别",
				"attrDegree" : 3819,
				"attrChange" : 100,
				"attrValue" : "血糖仪",
				"degree" : 2960,
				"change" : 100
			}, {
				"ratio" : 20,
				"value_r" : 841.5,
				"value" : 10,
				"feature" : "试纸",
				"attrValues" : [],
				"attrName" : "类别",
				"attrDegree" : 3819,
				"attrChange" : 100,
				"attrValue" : "试纸",
				"degree" : 829,
				"change" : 100
			}, {
				"ratio" : 260,
				"value_r" : 830,
				"value" : 110,
				"feature" : "三诺",
				"attrValues" : [],
				"attrName" : "品牌",
				"attrDegree" : 1895,
				"attrChange" : 100,
				"attrValue" : "三诺",
				"degree" : 574,
				"change" : 100
			}, {
				"ratio" : 140,
				"value_r" : 630,
				"value" : 310,
				"feature" : "罗氏",
				"attrValues" : [],
				"attrName" : "品牌",
				"attrDegree" : 1895,
				"attrChange" : 100,
				"attrValue" : "罗氏",
				"degree" : 555,
				"change" : 100
			}, {
				"ratio" : 20,
				"value_r" : 671.5,
				"value" : 210,
				"feature" : "强生",
				"attrValues" : [],
				"attrName" : "品牌",
				"attrDegree" : 1895,
				"attrChange" : 100,
				"attrValue" : "强生",
				"degree" : 134,
				"change" : 100
			}, {
				"ratio" : 260,
				"value_r" : 630,
				"value" : 310,
				"feature" : "鱼跃",
				"attrValues" : [],
				"attrName" : "品牌",
				"attrDegree" : 1895,
				"attrChange" : 100,
				"attrValue" : "鱼跃",
				"degree" : 124,
				"change" : 100
			}, {
				"ratio" : 140,
				"value_r" : 671.5,
				"value" : 210,
				"feature" : "欧姆龙",
				"attrValues" : [],
				"attrName" : "品牌",
				"attrDegree" : 1895,
				"attrChange" : 100,
				"attrValue" : "欧姆龙",
				"degree" : 114,
				"change" : 100
			}, {
				"ratio" : 140,
				"value_r" : 430,
				"value" : 510,
				"feature" : "罗康全",
				"attrValues" : [],
				"attrName" : "品牌",
				"attrDegree" : 1895,
				"attrChange" : 100,
				"attrValue" : "罗康全",
				"degree" : 66,
				"change" : 100
			}, {
				"ratio" : 20,
				"value_r" : 501.5,
				"value" : 410,
				"feature" : "ROCHE",
				"attrValues" : [],
				"attrName" : "品牌",
				"attrDegree" : 1895,
				"attrChange" : 100,
				"attrValue" : "ROCHE",
				"degree" : 56,
				"change" : 100
			}, {
				"ratio" : 260,
				"value_r" : 430,
				"value" : 510,
				"feature" : "怡成",
				"attrValues" : [],
				"attrName" : "品牌",
				"attrDegree" : 1895,
				"attrChange" : 100,
				"attrValue" : "怡成",
				"degree" : 44,
				"change" : 100
			}, {
				"ratio" : 140,
				"value_r" : 501.5,
				"value" : 410,
				"feature" : "会好",
				"attrValues" : [],
				"attrName" : "品牌",
				"attrDegree" : 1895,
				"attrChange" : 100,
				"attrValue" : "会好",
				"degree" : 42,
				"change" : 100
			}, {
				"ratio" : 380,
				"value_r" : 430,
				"value" : 510,
				"feature" : "艾科",
				"attrValues" : [],
				"attrName" : "品牌",
				"attrDegree" : 1895,
				"attrChange" : 100,
				"attrValue" : "艾科",
				"degree" : 34,
				"change" : 100
			}, {
				"ratio" : 140,
				"value_r" : 230,
				"value" : 710,
				"feature" : "雅培",
				"attrValues" : [],
				"attrName" : "品牌",
				"attrDegree" : 1895,
				"attrChange" : 100,
				"attrValue" : "雅培",
				"degree" : 33,
				"change" : 100
			}, {
				"ratio" : 20,
				"value_r" : 331.5,
				"value" : 610,
				"feature" : "采血针",
				"attrValues" : [],
				"attrName" : "类别",
				"attrDegree" : 3819,
				"attrChange" : 100,
				"attrValue" : "采血针",
				"degree" : 30,
				"change" : 100
			}, {
				"ratio" : 260,
				"value_r" : 230,
				"value" : 710,
				"feature" : "拜耳",
				"attrValues" : [],
				"attrName" : "品牌",
				"attrDegree" : 1895,
				"attrChange" : 100,
				"attrValue" : "拜耳",
				"degree" : 23,
				"change" : 100
			}, {
				"ratio" : 140,
				"value_r" : 331.5,
				"value" : 610,
				"feature" : "九安",
				"attrValues" : [],
				"attrName" : "品牌",
				"attrDegree" : 1895,
				"attrChange" : 100,
				"attrValue" : "九安",
				"degree" : 21,
				"change" : 100
			}, {
				"ratio" : 380,
				"value_r" : 230,
				"value" : 710,
				"feature" : "OMRON",
				"attrValues" : [],
				"attrName" : "品牌",
				"attrDegree" : 1895,
				"attrChange" : 100,
				"attrValue" : "OMRON",
				"degree" : 14,
				"change" : 100
			}, {
				"ratio" : 260,
				"value_r" : 331.5,
				"value" : 610,
				"feature" : "美国会好",
				"attrValues" : [],
				"attrName" : "品牌",
				"attrDegree" : 1895,
				"attrChange" : 100,
				"attrValue" : "美国会好",
				"degree" : 12,
				"change" : 100
			}, {
				"ratio" : 140,
				"value_r" : 30,
				"value" : 910,
				"feature" : "美迪信",
				"attrValues" : [],
				"attrName" : "品牌",
				"attrDegree" : 1895,
				"attrChange" : 100,
				"attrValue" : "美迪信",
				"degree" : 12,
				"change" : 100
			}, {
				"ratio" : 20,
				"value_r" : 161.5,
				"value" : 810,
				"feature" : "进口",
				"attrValues" : [],
				"attrName" : "产地",
				"attrDegree" : 12,
				"attrChange" : 100,
				"attrValue" : "进口",
				"degree" : 11,
				"change" : 100
			}, {
				"ratio" : 260,
				"value_r" : 30,
				"value" : 910,
				"feature" : "测利得",
				"attrValues" : [],
				"attrName" : "品牌",
				"attrDegree" : 1895,
				"attrChange" : 100,
				"attrValue" : "测利得",
				"degree" : 9,
				"change" : 100
			}, {
				"ratio" : 140,
				"value_r" : 161.5,
				"value" : 810,
				"feature" : "瑞迪恩",
				"attrValues" : [],
				"attrName" : "品牌",
				"attrDegree" : 1895,
				"attrChange" : 100,
				"attrValue" : "瑞迪恩",
				"degree" : 8,
				"change" : 100
			}, {
				"ratio" : 380,
				"value_r" : 30,
				"value" : 910,
				"feature" : "BAYER",
				"attrValues" : [],
				"attrName" : "品牌",
				"attrDegree" : 1895,
				"attrChange" : 100,
				"attrValue" : "BAYER",
				"degree" : 7,
				"change" : 100
			}, {
				"ratio" : 260,
				"value_r" : 161.5,
				"value" : 810,
				"feature" : "AIKE",
				"attrValues" : [],
				"attrName" : "品牌",
				"attrDegree" : 1895,
				"attrChange" : 100,
				"attrValue" : "AIKE",
				"degree" : 4,
				"change" : 100
			}, {
				"ratio" : 500,
				"value_r" : 30,
				"value" : 910,
				"feature" : "虹吸式",
				"attrValues" : [],
				"attrName" : "采血方式",
				"attrDegree" : 4,
				"attrChange" : 100,
				"attrValue" : "虹吸式",
				"degree" : 4,
				"change" : 100
			}]

};
(function($) {
	var methods = {
		init : function(options) {
			var scope=this;
			// rapher
			var attrs = Raphael._availableAttrs;
			attrs.font = '12px "Arial", "Microsoft Yahei"';
			attrs["font-size"] = "12";
			if (!Raphael.svg)
				attrs.font = '12px "Microsoft Yahei"', attrs["font-size"] = "12";
			this.opts = options;
			this.sets = {
				stsTitl : {},
				stsBgs : {},
				stsTags : {},
				stsValv : {},
				stsPoly : {},
				stsCirc : {},
				stsText : {},
				stsHove : {},
				stsLayer : {}
			};
			this.OPTS = {
				padds : {
					title : 10,
					left : 10,
					right : 20,
					bottom : 20,
					maxR : 9,
					bgLbar : 38,
					bgCright : 15,
					tagHig : 0
				}
			};
			this.paper = Raphael(options.divID);
			this.topN = options.topN || 4;
			this.opts.padds = this.sCopy(this.padds || {}, this.OPTS.padds);
			this.paper.gsid = this.gsid();
			return methods;
		},
		sCopy : function(a, c) {
			for (var d in c)
				d in a || (a[d] = c[d]);
			return a;
		},
		getColor : function(a) {
			var b = ["#6e87d7", "#11c897", "#fa7256", "#b172c5", "#f367a7"],
			c = b.length;
			return b[(a || 0) % c];
		},
		each : function() {
			$.each.apply(this, arguments);
		},
		gsid : function(a) {
			var c = 0;
			a += "_gsid_";
			return function(d) {
				var e = d ? d.id || "" : "";
				if (e === "")
					e = a + c++, d && (d.id = e);
				return e;
			};
		}("auto"),
		drawBg : function() {
			function n(h) {
				var o = l.slice();
				o[13] = o[9] += h;
				o[11] += h;
				return o;
			}
			var j = this.paper, i = $("#" + this.opts.divID);
			j = j.setSize(i.width(), i.height());
			i = this.opts.padds;
			var p = i.width = j.width, x = i.height = j.height, u = i.bgTop = i.title
					+ i.tagHig, y = i.bgWidth = p - i.left - i.right, z = i.bgHeight = x
					- u - i.bottom, C = i.bgRight = p - i.right;
			y = i.bgCwidth = y - i.bgCright - i.bgLbar;
			var c = i.bgBottom = x - i.bottom, a = i.bgMiddle = u + z / 2, d = this.sets, b = d.stsBgs;
			d = d.stsLayer;
			for (var e = b.bgCircs || (b.bgCircs = []), g = ["#dbdfeb",
					"#e4e7f2", "#eaecf5", "#f0f2f8", "#f3f5f9", "#f7f8fa"], f = g.length; f--;)
				(e[f] || (e[f] = j.circle(i.left + i.bgLbar, a, 0).attr({
							stroke : "#ffffff",
							"stroke-weight" : 1
						}))).attr({
							r : y * (f + 1) / 6,
							fill : g[f]
						});
			(b.axisX || (b.axisX = j.path().attr({
						stroke : "#ffffff",
						"stroke-width" : 1
					}))).attr({
						path : ["M", 0, a, p, a]
					});
			p = ["M", -5, -5, "L", -5, 5 + x, 5 + p, 5 + x, 5 + p, c, i.left,
					c, i.left, u, 5 + p, u, 5 + p, -5, -5, -5];
			(b.bgMask || (b.bgMask = j.path().attr({
						fill : "#ffffff",
						stroke : "none"
					}))).attr({
						path : p
					});
			(b.lBar || (b.lBar = j.rect().attr({
						fill : "#f7f8fa",
						stroke : "#dbdfeb",
						"stroke-width" : "0.9"
					}))).attr({
						x : i.left,
						y : u + 1,
						width : i.bgLbar,
						height : z - 2
					});
			var l = ["M", 17, 0, "L", 34, 13, 29, 13, 29, 23, 17, 13, 5, 23, 5,
					13, 0, 13, 17, 0];
			(b.arrUp || (b.arrUp = j.path(n(40)).attr({
						stroke : "none",
						fill : "#ffb049"
					}))).transform("t" + (i.left + 2) + "," + (u + 2));
			(b.arrUp_ex || (b.arrUp_ex = j.path(["M", 0, 0, "L", 24, 0, 24, 24,
					0, 24, 0, 0]).attr({
						stroke : "none",
						fill : "90-#ffffff-#ffb049"
					}))).transform("t" + (i.left + 7) + "," + (u + 45));
			(b.arrDown || (b.arrDown = j.path(n(40)).attr({
						stroke : "none",
						fill : "#606e82"
					}))).transform("t" + (i.left + (Raphael.svg ? 2 : -1))
					+ "," + (c - 40 - 26) + "r180");
			(b.arrDown_ex || (b.arrDown_ex = j.path(["M", 0, 0, "L", 24, 0, 24,
					24, 0, 24, 0, 0]).attr({
						stroke : "none",
						fill : "90-#606e82-#ffffff"
					}))).transform("t" + (i.left + 7) + "," + (c - 40 - 30));
			(b.arrRight || (b.arrRight = j.path(n(66)).attr({
						stroke : "none",
						fill : "#999999"
					}))).transform("t" + (C - 66 - 13) + "," + (a - 33 - 12)
					+ "r90");
			(b.arrRight_ex || (b.arrRight_ex = j.path(["M", 0, 0, "L", 24, 0,
					24, 24, 0, 24, 0, 0]).attr({
						stroke : "none",
						fill : "0-#ffffff-#999999"
					}))).transform("t" + (C - 66 - 45) + "," + (a - 12.5));
			(b.txtUp || (b.txtUp = j.text(0, 0, "上升".split("").join("\n"))
					.attr({
								"text-anchor" : "start",
								fill : "#ffffff"
							}))).attr({
						x : i.left + 13,
						y : u + 32
					});
			(b.txtUp2 || (b.txtUp2 = j
					.text(0, 0, "环比需求变化".split("").join("\n")).attr({
								"text-anchor" : "start",
								fill : "#999999"
							}))).attr({
						x : i.left + 13,
						y : u + 110
					});
			(b.txtDown2 || (b.txtDown2 = j.text(0, 0,
					"环比需求变化".split("").join("\n")).attr({
						"text-anchor" : "start",
						fill : "#999999"
					}))).attr({
						x : i.left + 13,
						y : c - 110
					});
			(b.txtDown || (b.txtDown = j.text(0, 0, "下降".split("").join("\n"))
					.attr({
								"text-anchor" : "start",
								fill : "#ffffff"
							}))).attr({
						x : i.left + 13,
						y : c - 32
					});
			(b.txtRight || (b.txtRight = j.text(0, 0, "需求度变弱").attr({
						"text-anchor" : "start",
						fill : "#ffffff"
					}))).attr({
						x : C - 66 - 26,
						y : a - 1
					});
			(b.circWord || (b.circWord = j
					.circle(i.left + i.bgLbar + 30, a, 55))).attr({
						fill : this.getColor(0),
						stroke : "#ffffff",
						"stroke-width" : 6
					});
			(b.textWord || (b.textWord = j.text(i.left + i.bgLbar + 30, a, "")))
					.attr({
								fill : "#ffffff",
								"font-size" : "14px"
							});
			(b.textNodata || (b.textNodata = j.text(0, 0, "无数据").hide()))
					.attr(this.sCopy({
								x : y / 2,
								y : a
							}, "无数据"));
			if (!d.bg)
				d.bg = j.path();
			return this;
		},
		/**
		 * 设置数据
		 */
		setData : function(n) {
			var maxX = 0;
			var maxY = 0;
			n.items = [];
			$.each(n.features, function(j, i) {
						n.items.push({
									text : i.feature,
									value_r : i.value_r / 1E3,
									xy : [i.value / 1E3, i.ratio / 1E3],
									attrValues : i.attrValues,
									degree : i.degree,
									attrValue : i.attrValue,
									change : i.change,
									attrName : i.attrName,
									attrDegree : i.attrDegree,
									attrChange : i.attrChange
								});
					});
			this.datas = n;
			return this;
		},
		/**
		 * 画数据点
		 */
		drawCircle : function(n) {
			// 定义scope
			var scope = this;
			var j = this.opts.padds, i = j.bgHeight / 2, p = Math
					.sqrt(j.bgCwidth * j.bgCwidth - i * i), x = j.bgCwidth / 6, u = this.paper, y = this.sets, z = y.stsCirc, C = z[""]
					|| (z[""] = []);
			z = y.stsText;
			var c = z[""] || (z[""] = []);
			z = y.stsLayer;
			if (n) {
				y.stsBgs.circWord.attr({
							fill : n
						});
				y.stsBgs.textWord.attr({
							text : this.text_n(this.datas.key)
						});
			}
			if (!this.datas)
				return this;
			$.each(this.datas.items, function(a, d) {
						// 正数增长 负数下降
						var attrText = " 环比增长:";
						var attrValueText = " 环比增长：";
						if (d.attrChange < 0) {
							attrText = " 环比下降：";
							d.attrChange = -d.attrChange;
						}
						if (d.change < 0) {
							attrValueText = " 环比下降：";
							d.change = -d.change;
						}
						var b = d.xy.slice(), e = 0, g = Math
								.floor((1 - d.value_r) * 5);
						g = Math.floor(d.xy[0] * 5);
						if (g > 4)
							g = 4;
						e = j.maxR - g * 1.5;
						b[0] *= p - j.maxR;
						b[1] *= i - j.maxR;
						if (g == 4)
							b[1] = d.xy[1] * (i - j.maxR - 20)
									+ (d.xy[1] >= 0 ? 20 : -20);
						var f = Math.sqrt(x * (g + 2) * x * (g + 2) - b[1]
								* b[1]);
						f -= e;
						var l = Math.abs(b[1]) < x * (g + 1) ? Math.sqrt(x
								* (g + 1) * x * (g + 1) - b[1] * b[1]) : 0;
						l += e;
						b[0] = (f - l) * (d.xy[0] - 0.2 * g) / 0.2 + l;
						b[0] += j.left + j.bgLbar;
						b[1] = j.bgMiddle - b[1];
						(C[a] || (C[a] = u.circle().attr({
									stroke : "#ffffff"
								}).data("posInfo", {
									text : d.text,
									attrValues : d.attrValues,
									"cx" : b[0],
									"cy" : b[1]
								}).hover(function() {
							this.attr("r", this.data("cr") * 1.4);
							var str = scope.createPopTable(
									this.data("posInfo").text, this
											.data("posInfo").attrValues);
							$("#popover div").remove();
							$("#popover").append(str);
							$("#popover div").css({
										display : "block",
										left : this.data("posInfo").cx,
										top : this.data("posInfo").cy,
										"z-index" : "100000000"
									});
						}, function() {
							this.attr("r", this.data("cr"));
							$("#popover div").css({
										display : "none"
									});
						}))).attr({
							cx : b[0],
							cy : b[1],
							r : e,
							fill : d.xy[1] >= 0 ? "#ffb049" : "#606e82",
							"stroke-width" : 2,
							// title : d.text
							title : '"属性" ' + d.attrName + ' 搜索次数：'
									+ d.attrDegree + attrText + d.attrChange
									+ '%\r"属性值 "' + d.attrValue + '搜索次数：'
									+ d.degree + attrValueText + d.change + "%"
						}).data("cr", e).show();

						f = b[0] + e + 3;
						b = b[1];
						if (b + 8 > j.bgBottom)
							b = j.bgBottom - 8;
						else if (b - 8 < j.bgTop)
							b = j.bgTop + 8;
						(c[a] || (c[a] = u.text().attr({
									"text-anchor" : "start"
								}))).attr({
									x : f,
									y : b,
									text : d.text,
									fill : g > 2 ? "#999999" : "#333333",
									title : d.text

								}).show();
						if (g > 3) {
							d = c[a].getBBox().width;
							if (f + d > j.bgRight - j.bgCright) {
								f -= d + e * 2 + 6;
								c[a].attr({
											x : f
										});
							}
						}
					});
			for (n = this.datas.items.length; n < C.length; n++) {
				C[n].hide();
				c[n].hide();
			}
			y.stsBgs.textNodata[this.datas.items.length ? "hide" : "show"]();
			if (!z.circ)
				z.circ = u.path();
			return this;
		},
		/**
		 * 
		 */
		text_n : function(n) {
			for (var j = [], i = n.length, p = 0; p < i - 1; p++)
				if (n.charCodeAt(p) < 256 && n.charCodeAt(p + 1) < 256) {
					j.push(n.slice(p, p + 2));
					p++;
				} else
					j.push(n.slice(p, p + 1));
			p < i && j.push(n.slice(-1));
			if (j.length > 12) {
				j.length = 11;
				j.push("aaa");
			}
			i = j.length;
			i > 6 && j.splice(Math.floor(i / 2), 0, "\n");
			return j.join("");
		},
		/**
		 * 
		 */
		createPopTable : function(attrName, attrValues) {
			// tyle=\"position:absolute;background-color:white;border-radius:
			// 6px;border: 1px solid rgba(0, 0, 0, 0.2);\"
			// 如果没有属性值，不弹出窗口
			if (attrValues.length == 0) {
				return "";
			}
			var tableStr = "<div  style=\"position:absolute;background-color:white;border-radius: 6px;border: 1px solid rgba(0, 0, 0, 0.2);\"class=\" table-responsive\">"
					+ "<table class=\"table table-bordered table-hover table-striped\">"
					+ "<thead>"
					+ "<tr style=\"width:400px\">"
					+ "<th>"
					+ attrName
					+ "</th>"
					+ "<th>搜索次数</th>"
					+ "<th>搜索次数环比变化</th>" + "</thead>" + "<tbody>";

			for (var i = 0; i < attrValues.length; i++) {
				var child = attrValues[i];
				tableStr += "<tr>";
				tableStr += "<td>" + child.attrValue + "</td>";
				tableStr += "<td>" + child.degree + "</td>";
				tableStr += "<td>" + child.change + "</td>";
				tableStr += "</tr>";
			}
			tableStr += "</tbody>";
			tableStr += "</table>";
			tableStr += "</div>";
			// alert(tableStr);

			return tableStr;

		}

	};

	$.fn.demandGraph = function(method) {

		if (methods[method]) {
			return methods[method].apply(this, Array.prototype.slice.call(
							arguments, 1));
		} else if (typeof method === 'object' || !method) {
			return methods.init.apply(methods, arguments);
		} else {
			$.error('Method ' + method + ' does not exist on jQuery.demandGraph');
		}

	};

})(jQuery);
$.widget("ui.soneHeader", {
	options : {
		modelNames : ['零售罗盘', '供应商罗盘', '零售罗盘', '供应商罗盘', '零售罗盘', '供应商罗盘',
				'零售罗盘', '供应商罗盘'],
		messages : [{
					uImg : 'http://placeholder.qiniudn.com/39x39/f60/fff',
					uName : 'DIvyia',
					uInfo : '刚才看见你的数据，有些想法刚才看见你的数据，有些想法',
					uTime : '2分钟前'
				},{
					uImg : 'http://placeholder.qiniudn.com/39x39/fc0/fff',
					uName : 'DIvyia',
					uInfo : '刚才看见你的数据，有些想法刚才看见你的数据，有些想法',
					uTime : '2分钟前'
				},{
					uImg : 'http://placeholder.qiniudn.com/39x39/f60/fff',
					uName : 'DIvyia',
					uInfo : '刚才看见你的数据，有些想法刚才看见你的数据，有些想法',
					uTime : '2分钟前'
				}],
		projects : [{
					projectName : 'A项目',
					pct : '80%',
					style:'p-type1'
				}, {
					projectName : 'B项目',
					pct : '85%',
					style:'p-type2'
				}, {
					projectName : 'C项目',
					pct : '70%',
					style:'p-type3'
				}]
	},

	_create : function() {
		var scope = this;
		var myData = this.options.modelNames;
		var tpl = $('<div class="header-main"> '
				+ '<div class="logo">UI标准化模版</div>'
				+ '<div class="nav">'
				+ '<ul></ul>'
				+ '</div>'
				+ '<div class="nav-option">'
				+ '<a href="javascript:;" class="prev">&lt;</a>'
				+ ' <a href="javascript:;" class="next">&gt;</a>'
				+ ' </div>'
				+ '<div class="search-bar">'
				+ '  <input type="text"><a href="javascript:;"></a>'
				+ ' </div>'
				+ '<div class="user">'
				+ '  <a href=""><img src="http://placeholder.qiniudn.com/36x36/ee0/fff" width="36" height="36" alt="">David Stevenson</a>'
				+ ' </div>' 
				+ ' <div class="messages">'
				+ ' <dl class="item fore1"><dt><b>5</b></dt><dd> </dd></dl>'
				+ '<dl class="item fore2">'
				+ ' <dt><b>4</b></dt><dd>' + ' <h4>4个项目正在进行</h4>'
				+ ' <ul> </ul></dd>' 
				+ ' </dl>' 
				+ '</div> </div>');

		$.each(this.options.modelNames, function(k, v) {
					var tmp = '';
					if (k == 0) {
						tmp = 'class="curr"';
					}
					tpl.find(".nav ul").append('<li ' + tmp + ' ><a href="">'
							+ v + '</a></li>');
				});
		$.each(this.options.messages, function(k, v) {

					var item='<a href="" class="line"> '+
	                 ' <span class="u-img"><img src="'+v.uImg+'" alt=""></span>'+
	                  '<span class="u-name">'+v.uName+'</span>'+
	                 ' <span class="u-info">'+v.uInfo+'</span>'+
	                 ' <span class="u-time">'+v.uTime+'</span>'+
                	'</a>';
					tpl.find(".messages .item.fore1 dd").append(item);
				});
				
		$.each(this.options.projects, function(k, v) {

					var item= '<li>'+
								'<a href="">'+
								  '<span class="txt">'+
									'<span class="tit">'+v.projectName+'</span>'+
									'<span class="pct">'+v.pct+'</span>'+
								  '</span>'+
								  '<span class="progress '+ v.style+'"><b style="width:'+v.pct+'"></b><s></s></span>'+
								'</a>'+
							  '</li>';
					tpl.find(".messages  .item.fore2 dd ul").append(item);
				});

		scope.element.html(tpl);

		scope._update(myData);
	},

	_setOption : function(key, value) {
		this.options[key] = value;

	},

	_update : function(data) {

		this._initEvents();
	},

	_initEvents : function(element) {
		var _ele = element || this.element;
		$(window).bind("load resize", function() {
			var topOffset = 50;
			var width = (this.window.innerWidth > 0)
					? this.window.innerWidth
					: this.screen.width;
			if (width < 768) {
				$('div.navbar-collapse', _ele).addClass('collapse');
				topOffset = 100; // 2-row-menu
			} else {
				$('div.navbar-collapse', _ele).removeClass('collapse');
			}

			var height = (this.window.innerHeight > 0)
					? this.window.innerHeight
					: this.screen.height;
			height = height - topOffset;
			if (height < 1)
				height = 1;
			if (height > topOffset) {
				$("#page-wrapper", _ele).css("min-height", (height) + "px");
			}
		});

		$(".messages dl", _ele).click(function(event) {
					event.stopPropagation();
					if ($(this).find("dd").css("display") == "none") {
						$(".messages").find("dd").hide();
						$(this).find("dd").show()
					} else {
						$(this).find("dd").hide()
					}
				});
		$(".messages dd", _ele).click(function(event) {
					event.stopPropagation();
				});
		$(document).click(function() {
					$(".messages", _ele).find("dd").hide();
				});
		window.onload = window.onresize = function() {
			var w = $(window).width();
			var n = $(".nav", _ele).find("li").length;
			var num = parseInt((w - 766) / 110);
			var step = 0;
			var isClick = false;
			if (n <= num) {
				num = n;
				$(".nav-option", _ele).hide();
			} else if (n > num) {
				$(".nav-option", _ele).show();
			}
			$(".nav", _ele).css("width", 110 * num + "px");
			$(".nav ul", _ele).css("width", 110 * n + "px");
			$(".nav-option .next", _ele).css("left", (110 * num + 255) + "px");

			$(".nav-option .next", _ele).click(function() {
						if (step < (n - num) && !isClick) {
							step++;
							isClick = true;
							$(".nav ul", _ele).animate({
										"left" : -step * 110 + "px"
									}, 1000);
							setTimeout(function() {
										isClick = false;
									}, 1000);
						}
					});
			$(".nav-option .prev", _ele).click(function() {
						if (step != 0 && !isClick) {
							step--;
							isClick = true;
							$(".nav ul", _ele).animate({
										"left" : -step * 110 + "px"
									}, 1000);
							setTimeout(function() {
										isClick = false;
									}, 1000);
						}
					});
		};

	},

	_destroy : function() {
		this.element.text("");
		$.Widget.prototype.destroy.call(this);

	}
});

/**
 * province picker
 * 地区选择弹出层函数
 * objid 选择区域的ID(input id) showid 弹出DIV的id input_cn 选择区域的ID(input id) input
 * input id 选择地区后将值放在input的隐藏变量中 QSarr strlen
 * 
 * @songquanwang
 */
;
(function($) {
		var areas = [{
			areaName : '华北地区',
			citys : [{
						cityName : '北京',
						cityCode : 'BJ'
					}, {
						cityName : '天津',
						cityCode : 'TJ'
					}, {
						cityName : '河北',
						cityCode : 'HBS'
					}, {
						cityName : '山西',
						cityCode : 'SXS'
					}, {
						cityName : '内蒙古',
						cityCode : 'NMGQ'
					}]
		},

		{
			areaName : '东北地区',
			citys : [{
						cityName : '辽宁',
						cityCode : 'LNS'
					}, {
						cityName : '吉林',
						cityCode : 'JLS'
					}, {
						cityName : '黑龙江',
						cityCode : 'HLJS'
					}]
		},

		{
			areaName : '华东地区',
			citys : [{
						cityName : '上海',
						cityCode : 'SH'
					}, {
						cityName : '江苏',
						cityCode : 'JS'
					}, {
						cityName : '浙江',
						cityCode : 'ZJ'
					}, {
						cityName : '安徽',
						cityCode : 'AHS'
					}, {
						cityName : '福建',
						cityCode : 'FJS'
					}, {
						cityName : '江西',
						cityCode : 'JXS'
					}
					, {
						cityName : '山东',
						cityCode : 'SDS'
					}]
		},

		{
			areaName : '华中地区',
			citys : [{
						cityName : '河南',
						cityCode : 'HNS'
					}, {
						cityName : '湖北',
						cityCode : 'HBS'
					}, {
						cityName : '湖南',
						cityCode : 'HUNS'
					}]
		},

		{
			areaName : '华南地区',
			citys : [{
						cityName : '广东',
						cityCode : 'GDS'
					}, {
						cityName : '广西',
						cityCode : 'GXS'
					}, {
						cityName : '海南',
						cityCode : 'HANS'
					}]
		},

		{
			areaName : '西南地区',
			citys : [{
						cityName : '重庆',
						cityCode : 'CQS'
					}, {
						cityName : '四川',
						cityCode : 'SCS'
					}, {
						cityName : '贵州',
						cityCode : 'GZS'
					}, {
						cityName : '云南',
						cityCode : 'YNS'
					}, {
						cityName : '西藏',
						cityCode : 'XZQ'
					}]
		},

		{
			areaName : '西北地区',
			citys : [{
						cityName : '陕西',
						cityCode : 'SXS'
					}, {
						cityName : '甘肃',
						cityCode : 'GSS'
					}, {
						cityName : '青海',
						cityCode : 'QHS'
					}, {
						cityName : '宁夏',
						cityCode : 'NXS'
					}, {
						cityName : '新疆',
						cityCode : 'XJS'
					}]
		}];

	var methods = {
		init : function(options) {
	        var id=options.showid.substring(1);
			var tpl=$('<div id="'+id+'">'+
					'<div class="OpenFloatBox">'+
						'<div class="modal fade" id="contactUsModal" tabindex="-1" '+
							'role="dialog" aria-labelledby="myModalLabel" aria-hidden="true"> '+
							'<div class="modal-dialog"> '+
								'<div class="modal-content"> '+
									'<div class="modal-header"> '+
										'<button type="button" class="close" data-dismiss="modal" '+
											'aria-hidden="true" id="contactAdmin_closeBtn"> '+
											'&times;</button> '+
										'<button id="saleAreaTop" name="area" type="button" '+
											'class="btn btn-primary">销售区域</button> '+
									'</div> '+
									'<div class="modal-body"> '+
										'<div id="sel_district" '+
											'style="border-top: solid 0px; border-color: #C0C0C0;"> '+
											'<div id="saleArea"> '+
												'<table class="table table-condensed" border="0"> '+	
                                                '</table> '+
											'</div> '+
											'<div class="txt"> '+
												'<div class="selecteditem"></div> '+
											'</div> '+
											'<div class="txt"> '+
												'<div align="center"> '+
													'<button id="confirmName" type="button" data-dismiss="modal" '+
														'name="confirmName" class="btn btn-primary">确定</button> '+
												'</div> '+
											'</div> '+
										'</div> '+
									'</div> '+
								'</div> '+
							'</div> '+
						'</div> '+
					'</div> '+
				'</div> ');
            $.each(areas, function(k, v) {
            	    var child=v;
            	    var str='<tr><td>'+v.areaName+'</td>';
            	    $.each(v.citys, function(ck, cv) {
            	    	str+='<td>'+
            	    	     '<td> '+
								'<div class="item" id="BJ"> '+
									'<label title='+cv.cityName+' class="titem">  '+
									 '<input type="checkbox" value='+cv.cityCode+'  title='+cv.cityName+'  class="b" /> '+cv.cityName+
									'</label> '+
									'<div class="sitem"></div> '+
								'</div> '+
							'</td> ';
            	    	
            	    });
            	    str+='</tr>'
					tpl.find(".table.table-condensed").append(str);
				});
			tpl.appendTo("body");

			var data = $(this).data('provincepicker');
			//没有配置项
			var opt = $.extend({

			}, options);
     
			this.OpenCategoryLayer(opt.objid, opt.showid, opt.input_cn, opt.input, opt.input_cn2,
				opt.input2, opt.QSarr, opt.strlen);
			return this;

		},

		destroy : function() {

			$(this).removeData('provincepicker');

		},
		OpenCategoryLayer : function(objid, showid, input_cn, input, input_cn2,
				input2, QSarr, strlen) {
			var scope=this;
			$(objid).click(function() {
				$(this).blur();
				$(showid + " .OpenFloatBoxBg").css("opacity", 0.2);
				$(showid).show();
				//$("#contactUsModal").removeClass("modal fade");
				$(showid + " .OpenFloatBox").css({
					"left" : ($(document).width() - $(showid + " .OpenFloatBox")
							.width())
							/ 2,
					"top" : "120",
					"z-index" : "999"
				});
				scope.SetBoxBg(showid);
				$(showid + " .item").unbind().hover(function() {
					$(this).find(".titem").addClass("titemhover");

					var strclass = QSarr[$(this).attr("id")];
					var pid = $(this).attr("id");
					if (strclass) {
						$(this).find(".sitem").css("display", "block");
						if ($(this).find(".sitem").html() == "") {
							$(this).find(".sitem").html(scope.MakeLi(strclass, pid));// 生成LI
						}
					}
					$(showid + " .OpenFloatBox label").unbind().click(
							function() {
								if ($(this).attr("title")) {
									if ($(this).find(":checkbox")
											.attr('checked')) {
										$(this).next().find(":checkbox").attr(
												'checked', true);
									} else {
										$(this).next().find(":checkbox").attr(
												'checked', false);
									}
								} else {
									if ($(this).parent()
											.find(":checkbox:checked").length > 0) {
										$(this).parent().prev()
												.find(":checkbox").attr(
														'checked', false);
									}
								}
								scope.CopyItem(showid);
							});
				}, function() {
					$(this).find(".titem").removeClass("titemhover");
					$(this).find(".sitem").css("display", "none");
				});
				$(showid + " .OpenFloatBox .DialogClose").unbind().hover(
						function() {
							$(this).addClass("spanhover")
						}, function() {
							$(this).removeClass("spanhover")
						});

				$(showid + " .close").click(function() {
							DialogClose(showid);
						});

				// 确定选择 按钮的ID 必须是 confirmName
				$("#confirmName").unbind().click(function() {
					SetInput(showid, input_cn, input, input_cn2, input2, strlen);
				});

				// 关闭
				function DialogClose(showid) {
					$(showid).hide();
				}
				// 设置表单
				function SetInput(showid, input_cn, input, input_cn2, input2,
						strlen) {
					var a_cn = new Array();
					var a_id = new Array();
					var i = 0;
					if ($(showid
							+ " .OpenFloatBox .selecteditem :checkbox:checked").length > 8) {
						alert("不能超过8个选项");
						return false;
					}
					$(showid
							+ " .OpenFloatBox .selecteditem :checkbox:checked")
							.each(function(index) {
								a_cn[index] = $(this).attr("title");
								if ($(this).attr("class") == "s") {
									a_id[i] = $(this).val();
								} else {
									a_id[i] = $(this).attr("id") + "."
											+ $(this).val();
								}
								i++;
							});
					$(input_cn).val(scope.limit(a_cn.join("+"), strlen));
					$(input_cn).attr("title", $(input_cn).val());
					$(input_cn2).val(scope.limit(a_cn.join("+"), strlen));
					if ($(input_cn).val() == "")
						$(input_cn).val("全部数据");
					if ($(input_cn2).val() == "")
						$(input_cn2).val("全部数据");
					$(input).val(a_id.join("-"));
					$(input2).val(a_id.join("-"));
					DialogClose(showid);
					//$("#contactUsModal").addClass("modal fade");
				}
			});
		},
		// 设置阴影
		SetBoxBg : function(showid) {
			var FloatBoxWidth = $(showid + " .OpenFloatBox").width();
			var FloatBoxHeight = $(showid + " .OpenFloatBox").height();
			var FloatBoxLeft = $(showid + " .OpenFloatBox").offset().left;
			var FloatBoxTop = $(showid + " .OpenFloatBox").offset().top;
			$(showid + " .OpenFloatBoxBg").css({
						display : "block",
						width : (FloatBoxWidth + 12) + "px",
						height : (FloatBoxHeight + 12) + "px"
					});
			$(showid + " .OpenFloatBoxBg").css({
						left : (FloatBoxLeft - 5) + "px",
						top : (FloatBoxTop - 5) + "px"
					});
		},
		// 生成小类
		MakeLi : function(val, pid) {
			if (val == "")
				return false;
			arr = val.split("|");
			var htmlstr = '';
			for (x in arr) {
				var v = arr[x].split(",");
				htmlstr += "<label><input type=\"checkbox\" value=\"" + v[0]
						+ "\" title=\"" + v[1] + "\" class=\"s\" id=\"" + pid
						+ "\"/>" + v[1] + "</label><br/>";
			}
			return htmlstr;
		},
		// 拷贝
		CopyItem : function(showid) {
			var scope=this;
			var htmlstr = '&nbsp;&nbsp;&nbsp;已经选择分类：<div class=\"btn-group btn-group-sm\"> <button type=\"button\" class=\"empty btn btn-default\">清空已选</button></div><br/><nobr>';
			$(showid + " .item :checkbox:checked[class='b']").each(
					function(index) {
						htmlstr += "<label>"
								+ "      &nbsp;&nbsp;&nbsp;&nbsp;<input class=\"s\"  type=\"checkbox\" value=\""
								+ $(this).attr("value") + "\" title=\""
								+ $(this).attr("title") + "\" checked/>"
								+ $(this).attr("title") + "</label>";
					})
			$(showid + " .item :checkbox:checked[class='s']").each(
					function(index) {
						if ($(this).parent().parent().prev().find(":checkbox")
								.attr('checked') == false) {
							htmlstr += "<label>"
									+ "   <input class=\"s\"  type=\"checkbox\" id=\""
									+ $(this).attr("id") + "\" value=\""
									+ $(this).attr("value") + "\" title=\""
									+ $(this).attr("title") + "\" checked/>"
									+ $(this).attr("title") + "</label>";
						}
					})
			htmlstr += "<div class=\"clear\"></div></nobr>";
			$(showid + " .selecteditem").html(htmlstr);
			if ($(showid + " .item :checkbox:checked").length > 0) {
				$(showid + " .selecteditem").css("display", "block");
			} else {
				$(showid + " .selecteditem").css("display", "none");
			}
			// 已选项目绑定click
			$(showid + " .selecteditem :checkbox").unbind().click(function() {
				var selval = $(this).val();
				$(showid + " .item :checkbox:checked").each(function() {
					if ($(this).val() == selval) {
						$(this).attr("checked", false);
						if ($(this).attr("class") == "b") {
							$(this).parent().next().find(":checkbox").attr(
									"checked", false);
						}
						// 重新克隆
						scope.CopyItem(showid);
					}
				})
			});
			$(showid + " .OpenFloatBox .item label :checkbox").parent().css(
					"color", "");
			$(showid + " .OpenFloatBox .item label :checkbox:checked")
					.parent().css("color", "#FF6600");
			$(showid + " .OpenFloatBox .sitem :checkbox:checked").each(
					function(index) {
						$(this).parent().parent().prev()
								.css("color", "#FF6600");
					});
			this.SetBoxBg(showid);
			// 清空
			$(showid + " .selecteditem .empty").unbind().click(function() {
				$(showid + " .selecteditem").css("display", "none");
				$(showid + " .selecteditem").html("");
				$(showid + " :checkbox:checked").parent().css("color", "");
				$(showid + " :checkbox:checked").parent().parent().prev().css(
						"color", "");
				$(showid + " :checkbox:checked").attr('checked', false);
				scope.SetBoxBg(showid);
			});
		},
		// 截取字符
		limit : function(objString, num) {
			var objLength = objString.length;
			if (objLength > num) {
				return objString.substring(0, num) + "...";
			}
			return objString;
		},
		// 模拟select
		showmenu : function(menuID, showID, inputname) {
			$(menuID).click(function() {
				$(menuID).blur();
				$(menuID).parent("div").css("position", "relative");
				$(showID).slideToggle("fast");
				// 生成背景
				$(menuID).parent("div")
						.before("<div class=\"menu_bg_layer\"></div>");
				$(".menu_bg_layer").height($(document).height());
				$(".menu_bg_layer").css({
							width : $(document).width(),
							position : "absolute",
							left : "0",
							top : "0",
							"z-index" : "0",
							"background-color" : "#ffffff"
						});
				$(".menu_bg_layer").css("opacity", "0");
				// 生成背景结束
				$(showID + " li").click(function() {
							$(menuID).val($(this).attr("title"));
							$(inputname).val($(this).attr("id"));
							$(".menu_bg_layer").hide();
							$(showID).hide();
							$(menuID).parent("div").css("position", "");
							$(this).css("background-color", "");
						});

				$(".menu_bg_layer").click(function() {
							$(".menu_bg_layer").hide();
							$(showID).hide();
							$(menuID).parent("div").css("position", "");
						});
				$(showID + " li").hover(function() {
							$(this).css("background-color", "#DAECF5");
						}, function() {
							$(this).css("background-color", "");

						});
			});
		}

	};
	

	// 扩展jquery原型
	$.fn.provincepicker = function(method) {
		if (methods[method]) {
			// 传递作用于为el $("el").monthpicker传递作用于为 $("el"),所有方法定义到这个元素
			return methods[method].apply(this, Array.prototype.slice.call(
							arguments, 1));
		} else if (typeof method === 'object' || !method) {
			return methods.init.apply(methods, arguments);
		} else {
			$.error('Method ' + method
					+ ' does not exist on jQuery.mtz.monthpicker');
		}
	};

})(jQuery);

//w2ui
$(function() {
    $('#grid').w2grid({
        name : 'grid',
        header : '列表名称',
        show : {
            toolbar : true,
            footer : true,
            header : true,
            lineNumbers: true,
            selectColumn: true,
            expandColumn: true
        },
        searches : [ {
            field : 'lname',
            caption : '名字',
            type : 'text'
        }, {
            field : 'fname',
            caption : '姓氏',
            type : 'text'
        }, {
            field : 'email',
            caption : '邮箱',
            type : 'text'
        } ],
        sortData : [ {
            field : 'recid',
            direction : 'ASC'
        } ],
        columns : [ {
            field : 'recid',
            caption : 'ID',
            size : '50px',
            sortable : true,
            attr : 'align=center'
        }, {
            field : 'lname',
            caption : '姓氏',
            size : '30%',
            sortable : true,
            resizable : true
        }, {
            field : 'fname',
            caption : '名字',
            size : '30%',
            sortable : true,
            resizable : true
        }, {
            field : 'email',
            caption : '邮件',
            size : '40%',
            sortable : true,
            resizable : true
        }, {
            field : 'sdate',
            caption : '起始时间',
            size : '120px',
            sortable : true,
            resizable : true
        } ],
        records : [ {
            recid : 1,
            fname : 'John',
            lname : 'doe',
            email : 'jdoe@gmail.com',
            sdate : '4/3/2012'
        }, {
            recid : 2,
            fname : 'Stuart',
            lname : 'Motzart',
            email : 'jdoe@gmail.com',
            sdate : '4/3/2012'
        }, {
            recid : 3,
            fname : 'Jin',
            lname : 'Franson',
            email : 'jdoe@gmail.com',
            sdate : '4/3/2012'
        }, {
            recid : 4,
            fname : 'Susan',
            lname : 'Ottie',
            email : 'jdoe@gmail.com',
            sdate : '4/3/2012'
        }, {
            recid : 5,
            fname : 'Kelly',
            lname : 'Silver',
            email : 'jdoe@gmail.com',
            sdate : '4/3/2012'
        }, {
            recid : 6,
            fname : 'Francis',
            lname : 'Gatos',
            email : 'jdoe@gmail.com',
            sdate : '4/3/2012'
        }, {
            recid : 7,
            fname : 'Mark',
            lname : 'Welldo',
            email : 'jdoe@gmail.com',
            sdate : '4/3/2012'
        }, {
            recid : 8,
            fname : 'Thomas',
            lname : 'Bahh',
            email : 'jdoe@gmail.com',
            sdate : '4/3/2012'
        }, {
            recid : 9,
            fname : 'Sergei',
            lname : 'Rachmaninov',
            email : 'jdoe@gmail.com',
            sdate : '4/3/2012'
        }, {
            recid : 20,
            fname : 'Jill',
            lname : 'Doe',
            email : 'jdoe@gmail.com',
            sdate : '4/3/2012'
        }, {
            recid : 21,
            fname : 'Frank',
            lname : 'Motzart',
            email : 'jdoe@gmail.com',
            sdate : '4/3/2012'
        }, {
            recid : 22,
            fname : 'Peter',
            lname : 'Franson',
            email : 'jdoe@gmail.com',
            sdate : '4/3/2012'
        }, {
            recid : 23,
            fname : 'Andrew',
            lname : 'Ottie',
            email : 'jdoe@gmail.com',
            sdate : '4/3/2012'
        }, {
            recid : 24,
            fname : 'Manny',
            lname : 'Silver',
            email : 'jdoe@gmail.com',
            sdate : '4/3/2012'
        }, {
            recid : 25,
            fname : 'Ben',
            lname : 'Gatos',
            email : 'jdoe@gmail.com',
            sdate : '4/3/2012'
        }, {
            recid : 26,
            fname : 'Doer',
            lname : 'Welldo',
            email : 'jdoe@gmail.com',
            sdate : '4/3/2012'
        }, {
            recid : 27,
            fname : 'Shashi',
            lname : 'bahh',
            email : 'jdoe@gmail.com',
            sdate : '4/3/2012'
        }, {
            recid : 28,
            fname : 'Av',
            lname : 'Rachmaninov',
            email : 'jdoe@gmail.com',
            sdate : '4/3/2012'
        }, {
            recid : 31,
            fname : 'John',
            lname : 'doe',
            email : 'jdoe@gmail.com',
            sdate : '4/3/2012'
        }, {
            recid : 32,
            fname : 'Stuart',
            lname : 'Motzart',
            email : 'jdoe@gmail.com',
            sdate : '4/3/2012'
        }, {
            recid : 33,
            fname : 'Jin',
            lname : 'Franson',
            email : 'jdoe@gmail.com',
            sdate : '4/3/2012'
        }, {
            recid : 34,
            fname : 'Susan',
            lname : 'Ottie',
            email : 'jdoe@gmail.com',
            sdate : '4/3/2012'
        }, {
            recid : 35,
            fname : 'Kelly',
            lname : 'Silver',
            email : 'jdoe@gmail.com',
            sdate : '4/3/2012'
        }, {
            recid : 36,
            fname : 'Francis',
            lname : 'Gatos',
            email : 'jdoe@gmail.com',
            sdate : '4/3/2012'
        }, {
            recid : 37,
            fname : 'Mark',
            lname : 'Welldo',
            email : 'jdoe@gmail.com',
            sdate : '4/3/2012'
        }, {
            recid : 38,
            fname : 'Thomas',
            lname : 'Bahh',
            email : 'jdoe@gmail.com',
            sdate : '4/3/2012'
        }, {
            recid : 39,
            fname : 'Sergei',
            lname : 'Rachmaninov',
            email : 'jdoe@gmail.com',
            sdate : '4/3/2012'
        }, {
            recid : 40,
            fname : 'Jill',
            lname : 'Doe',
            email : 'jdoe@gmail.com',
            sdate : '4/3/2012'
        }, {
            recid : 41,
            fname : 'Frank',
            lname : 'Motzart',
            email : 'jdoe@gmail.com',
            sdate : '4/3/2012'
        }, {
            recid : 42,
            fname : 'Peter',
            lname : 'Franson',
            email : 'jdoe@gmail.com',
            sdate : '4/3/2012'
        }, {
            recid : 43,
            fname : 'Andrew',
            lname : 'Ottie',
            email : 'jdoe@gmail.com',
            sdate : '4/3/2012'
        }, {
            recid : 44,
            fname : 'Manny',
            lname : 'Silver',
            email : 'jdoe@gmail.com',
            sdate : '4/3/2012'
        }, {
            recid : 45,
            fname : 'Ben',
            lname : 'Gatos',
            email : 'jdoe@gmail.com',
            sdate : '4/3/2012'
        }, {
            recid : 46,
            fname : 'Doer',
            lname : 'Welldo',
            email : 'jdoe@gmail.com',
            sdate : '4/3/2012'
        }, {
            recid : 47,
            fname : 'Shashi',
            lname : 'bahh',
            email : 'jdoe@gmail.com',
            sdate : '4/3/2012'
        }, {
            recid : 48,
            fname : 'Av',
            lname : 'Rachmaninov',
            email : 'jdoe@gmail.com',
            sdate : '4/3/2012'
        }, {
            recid : 51,
            fname : 'John',
            lname : 'doe',
            email : 'jdoe@gmail.com',
            sdate : '4/3/2012'
        }, {
            recid : 52,
            fname : 'Stuart',
            lname : 'Motzart',
            email : 'jdoe@gmail.com',
            sdate : '4/3/2012'
        }, {
            recid : 53,
            fname : 'Jin',
            lname : 'Franson',
            email : 'jdoe@gmail.com',
            sdate : '4/3/2012'
        }, {
            recid : 54,
            fname : 'Susan',
            lname : 'Ottie',
            email : 'jdoe@gmail.com',
            sdate : '4/3/2012'
        }, {
            recid : 55,
            fname : 'Kelly',
            lname : 'Silver',
            email : 'jdoe@gmail.com',
            sdate : '4/3/2012'
        }, {
            recid : 56,
            fname : 'Francis',
            lname : 'Gatos',
            email : 'jdoe@gmail.com',
            sdate : '4/3/2012'
        }, {
            recid : 57,
            fname : 'Mark',
            lname : 'Welldo',
            email : 'jdoe@gmail.com',
            sdate : '4/3/2012'
        }, {
            recid : 58,
            fname : 'Thomas',
            lname : 'Bahh',
            email : 'jdoe@gmail.com',
            sdate : '4/3/2012'
        }, {
            recid : 59,
            fname : 'Sergei',
            lname : 'Rachmaninov',
            email : 'jdoe@gmail.com',
            sdate : '4/3/2012'
        }, {
            recid : 60,
            fname : 'Jill',
            lname : 'Doe',
            email : 'jdoe@gmail.com',
            sdate : '4/3/2012'
        }, {
            recid : 61,
            fname : 'Frank',
            lname : 'Motzart',
            email : 'jdoe@gmail.com',
            sdate : '4/3/2012'
        }, {
            recid : 62,
            fname : 'Peter',
            lname : 'Franson',
            email : 'jdoe@gmail.com',
            sdate : '4/3/2012'
        }, {
            recid : 63,
            fname : 'Andrew',
            lname : 'Ottie',
            email : 'jdoe@gmail.com',
            sdate : '4/3/2012'
        }, {
            recid : 64,
            fname : 'Manny',
            lname : 'Silver',
            email : 'jdoe@gmail.com',
            sdate : '4/3/2012'
        }, {
            recid : 65,
            fname : 'Ben',
            lname : 'Gatos',
            email : 'jdoe@gmail.com',
            sdate : '4/3/2012'
        }, {
            recid : 66,
            fname : 'Doer',
            lname : 'Welldo',
            email : 'jdoe@gmail.com',
            sdate : '4/3/2012'
        }, {
            recid : 67,
            fname : 'Shashi',
            lname : 'bahh',
            email : 'jdoe@gmail.com',
            sdate : '4/3/2012'
        }, {
            recid : 68,
            fname : 'Av',
            lname : 'Rachmaninov',
            email : 'jdoe@gmail.com',
            sdate : '4/3/2012'
        } ]
        ,
        onExpand: function (event) {
            $('#'+event.box_id).html('<div style="padding: 10px">Expanded content</div>').animate({ 'height': 100 }, 100);
        }
    });
});

// 左边菜单功能
$('#left-menu').soneLeftMenu({
    value:1
});
$('#header').soneHeader();

var panel=$("#raphael").demandGraph({divID : "raphael"});
	panel.setData(mockData);
	panel.drawBg("#ffb049");
	panel.drawCircle("#4284e2");
	
   /*$("#sub-nav .collapseNav i").click(function(){
	   $("#sub-nav ul").toggle(function(){

		   $("#sub-nav").css("height","10px");
			 $("#sub-nav .collapseNav i").removeClass("fa-sort-up");	 
			 $("#sub-nav .collapseNav i").addClass("fa-sort-desc");	
		},function(){
			 $("#sub-nav ul").css("height","44px");
			 $("#sub-nav .collapseNav i").removeClass("fa-sort-desc");	 
			 $("#sub-nav .collapseNav i").addClass("fa-sort-up");	
		});
   
   });*/
   var numflag=0;
    $("#sub-nav div").click(function(){
           if(numflag==0){
		     $("#sub-nav").css("height","10px");
			 $("#sub-nav ul").css("display","none");
			 $("#sub-nav .collapseNav i").removeClass("fa-sort-up");	 
			 $("#sub-nav .collapseNav i").addClass("fa-sort-desc");	
			 numflag=1;
		   
		   }else{
		     $("#sub-nav").css("height","44px");
			 $("#sub-nav ul").css("display","block");
			 $("#sub-nav .collapseNav i").removeClass("fa-sort-desc");	 
			 $("#sub-nav .collapseNav i").addClass("fa-sort-up");	
		     numflag=0;
		   } 
			 
	});
	
	$("#district_cn").provincepicker({
		objid:"#district_cn", showid:"#sel_district", input_cn:"#district_cn", input:"#citycategory",
		input_cn2:"#district_cn2",
		input2:"#citycategory2", QSarr:new Array(), strlen:100
	});
	$("#district_cn").click(function(event) {
				$('#contactUsModal').modal('show');
			});


/*$(window).bind("load resize", function() {
    topOffset = 50;
    width = (this.window.innerWidth > 0) ? this.window.innerWidth : this.screen.width;
    if (width < 768) {
        $('div.navbar-collapse').addClass('collapse');
        topOffset = 100; // 2-row-menu
    } else {
        $('div.navbar-collapse').removeClass('collapse');
    }

    height = (this.window.innerHeight > 0) ? this.window.innerHeight : this.screen.height;
    height = height - topOffset;
    if (height < 1) height = 1;
    if (height > topOffset) {
        $("#page-wrapper").css("min-height", (height) + "px");
    }
});

$(".messages dl").click(function(event){
		event.stopPropagation();
		if($(this).find("dd").css("display")=="none"){
			$(".messages").find("dd").hide();
			$(this).find("dd").show()
		}
		else{
			$(this).find("dd").hide()
		}
	});
	$(".messages dd").click(function(event){
		event.stopPropagation();
	});
	$(document).click(function(){
		$(".messages").find("dd").hide();
	});
	window.onload=window.onresize=function(){
		var w=$(window).width();
		var n=$(".nav").find("li").length;
		var num=parseInt((w-766)/110);
		var step=0;
		var isClick=false;
		if(n<=num){
			num=n;
			$(".nav-option").hide();
		}
		else if(n>num){
			$(".nav-option").show();
		}
		$(".nav").css("width",110*num+"px");
		$(".nav ul").css("width",110*n+"px");
		$(".nav-option .next").css("left",(110*num+255)+"px");

		$(".nav-option .next").click(function(){
			if(step<(n-num)&&!isClick){
				step++;
				isClick=true;
				$(".nav ul").animate({"left":-step*110+"px"},1000);
				setTimeout(function(){isClick=false;},1000);
			}
		});
		$(".nav-option .prev").click(function(){
			if(step!=0&&!isClick){
				step--;
				isClick=true;
				$(".nav ul").animate({"left":-step*110+"px"},1000);
				setTimeout(function(){isClick=false;},1000);
			}
		});
	};    */